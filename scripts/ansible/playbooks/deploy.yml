- name: Deploy Verulink Attestor
  hosts: all
  become: true
  gather_facts: true
  roles:
    - cloud_common
    - secrets  # Always retrieve secrets from cloud Secret Manager first
    - prechecks
    - config
  tasks:
    - name: Include Docker role
      include_role:
        name: docker
      when: deployment_type | default('docker') == 'docker'
    
    - name: Include Kubernetes role
      include_role:
        name: k8s
      when: deployment_type | default('docker') == 'k8s'
